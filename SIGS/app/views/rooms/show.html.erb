<h1>Sala: <%= @room.name %></h1>
<div class="row">
  <div class="col-md-6">
    <ul class="list-group">
      <li class="list-group-item">Código: <%= @room.code %></li>
      <li class="list-group-item">Capacidade: <%= @room.capacity %></li>
      <li class="list-group-item">Status: <%= ((@room.active) ? 'Ativo' : 'Inativo') %></li>
      <li class="list-group-item">Prédio: <%= @room.building.name %></li>
    </ul>
  </div>
  <div class="col-md-6">
    <ul class="list-group">
      <li class="list-group-item"><h4>Recursos:</h4></li>
      <% @room_categories.each do |room_category| %>
        <li class="list-group-item"><%= room_category.name %></li>
      <% end %>
    </ul>
  </div>
</div>

<table class="table tableViewAllocation table-hover table-bordered">
  <thead>
    <% days = %w(Segunda Terça Quarta Quinta Sexta Sábado) %>
    <tr>
      <th>Horários</th>
      <% days.each do |day| %>
        <th><%= day %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% (6..23).each do |i| %>
      <tr>
        <th>
          <%= (i < 10 ? "0#{i}" : i) %>:00
        </th>
        <% days.each do |day| %>
          <td data-day-hour="<%= "#{day}#{i}" %>"></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="hide">
  <% @allocations.each do |allocation|
    start_time = allocation.start_time.strftime('%H:%M').to_i
    rowspan = allocation.final_time.strftime('%H').to_i - start_time
  %>
    <p class="dataAllocation" data-day="<%= allocation.day %>" data-hour="<%= start_time %>" data-rowspan="<%= rowspan %>" data-id="<%= allocation.id %>">
      <%= allocation.school_room.discipline.name %>
        <a href="!#" data-toggle="modal" data-target="#modalSchollRoom">
          <small>Turma: <%= allocation.school_room.name %></small>
        </a>
    </p>
  <% end %>
</div>

  <!-- <% @allocations_extensions.each do |allocation_extension| %>
  <h2><%= allocation_extension.id %><br></h2>
  <h2><%= allocation_extension.periodicity %><br></h2>
  <h2><%= allocation_extension.start_time.strftime('%H:%M') %><br></h2>
  <h2><%= allocation_extension.final_time.strftime('%H:%M') %><br></h2>
  <h2><%= allocation_extension.inicial_date %><br></h2>
  <h2><%= allocation_extension.final_date %><br></h2>
  <% end %> -->


<script type="text/javascript">
  $(document).ready(function() {
    $('.dataAllocation').each(function() {
      var day = $(this).attr("data-day");
      var hour = $(this).attr("data-hour");
      var rowspan = $(this).attr("data-rowspan");
      $(this).appendTo('.tableViewAllocation td[data-day-hour="' + day + hour + '"]').find('a').appendTo('.tableViewAllocation td[data-day-hour="' + day + hour + '"]');
      if (rowspan > 1 ) {
        $('.tableViewAllocation td[data-day-hour="' + day + hour + '"]').attr("rowspan", rowspan);
        for (i = 1; i < rowspan; i++) {
          var finalHour = parseInt(hour) + i;
          $('.tableViewAllocation td[data-day-hour="' + day + finalHour + '"]').remove();
        }
      }
    });
  });
</script>
