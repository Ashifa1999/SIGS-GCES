<h1>Salas</h1>
<table class="table">
  <tr>
  <%= form_tag(room_index_post_path, :method => :post) do %>
    <td>
      <%= label_tag("Nome") %>
      <%= text_field_tag 'name', nil, placeholder: 'Digite o nome da sala...', size: '40', class: 'form-control' %>
    </td>
    <td>
      <%= label_tag("Código") %>
      <%= text_field_tag 'code', nil, placeholder: 'Digite o código da sala...', size: '25', class: 'form-control' %>
    </td>
    <td>
      <%= label_tag("Capacidade") %>
      <%= number_field_tag 'capacity', nil, placeholder: 'Insira a quantidade...', size: '500', class: 'form-control' %>
    </td>
  </tr>

  <tr>
    <td>
      <%= label_tag("Prédio") %>
      <%= select_tag 'building_id', options_from_collection_for_select(@buildings, "id", "name"), include_blank: true %>
    </td>

    <td>
      <%= label_tag("Ala") %>
      <% itens = [["NORTE"], ["CENTRAL"], ["SUL"]] %>
      <%= select_tag 'wing', options_for_select(itens, " "), include_blank: true %>
    </td>
  </tr>

  <tr>
    <td><b>Funcionamento:</b></td>
    <td class="select_active">
    <%= label_tag(:active_ativa, "Ativa") %>
      <%= radio_button_tag(:ativo, "ativa", :id => "id_active") %>
    </td>
    <td>
    <%= label_tag(:active_inativa, "Inativa") %>
      <%= radio_button_tag(:ativo, "inativa", :id => "id_anative") %>
    </td>
  </tr>
  <tr>
    <td><%= submit_tag "Pesquisar"%></td>
  </tr>

</table>
<% end %>

  <% if @rooms.count == 0 %>
    <h3>Não há salas registradas no momento.</h3>
  <% else %>
    <table class="table">
    <thead>
      <tr>
        <th>Código</th>
        <th>Nome</th>
        <th>Ativo</th>
        <th>Prédio</th>
        <th style="text-align:center">Alterar</th>
        <th style="text-align:center">Visualizar</th>
      </tr>
    </thead>
    <tbody class="show_room">
      <% @rooms.each do |room| %>
        <tr>
          <td><%= room.code %></td>
          <td><%= room.name %></td>
          <td id="active_room"><%=  ((room.active) ? 'Sim' : 'Não')  %></td>
          <td><%= room.building.name %></td>
          <td style="text-align:center"><%= link_to image_tag("icon_edit.png"), room_edit_path(room.id) %></td>
          <td style="text-align:center"><%= link_to image_tag("icon_view.png"), room_path(room.id) %></td>
        </tr>
      <% end %>
    </tbody>
    </table>
  <% end %>

<script>
  var active;
  var bool;

  $("input:radio").click(function(){
    active = $(this).attr("value");
    if(active == "ativa"){
        bool = true;
    }else{
      bool = false;
    }

    if(bool){
      <% @rooms.each do |room| %>
        if (<%=room.active%>) {
          $(".show_room").html(
            "<tr>"
              + "<td><%=room.code%></td>"
              + "<td><%= room.name %></td>"
              + "<td id='active_room'><%=((room.active) ? 'Sim' : 'Não')  %></td>"
              + "<td><%= room.building.name %></td>"
              + '<td style="text-align:center"><%= link_to image_tag("icon_edit.png"), room_edit_path(room.id) %></td>'
              + '<td style="text-align:center"><%= link_to image_tag("icon_view.png"), room_path(room.id) %></td>'
            + "</tr>"
          )
      }
    <%end%>
  }else{
     <% @rooms.each do |room| %>
          $(".show_room").html(
            "<tr>"
              + "<td><%=room.code%></td>"
              + "<td><%= room.name %></td>"
              + "<td id='active_room'><%=  ((room.active) ? 'Sim' : 'Não')  %></td>"
              + "<td><%= room.building.name %></td>"
              + '<td style="text-align:center"><%= link_to image_tag("icon_edit.png"), room_edit_path(room.id) %></td>'
              + '<td style="text-align:center"><%= link_to image_tag("icon_view.png"), room_path(room.id) %></td>'
            + "</tr>"
          )
    <%end%>

  }

  });



</script>
